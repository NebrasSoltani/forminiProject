{% extends 'base.html.twig' %}

{% block body %}
<h1>Liste des apprenants</h1>

<a href="{{ path('admin_apprenant_new') }}">â• Ajouter apprenant</a>

<form method="get" action="{{ path('admin_apprenant_index') }}" style="margin: 10px 0;">
    <input type="text" name="q" value="{{ q|default('') }}" placeholder="Recherche (email/nom/prÃ©nom)">
    <select name="limit">
        {% set currentLimit = limit|default(10) %}
        <option value="10" {% if currentLimit == 10 %}selected{% endif %}>10</option>
        <option value="25" {% if currentLimit == 25 %}selected{% endif %}>25</option>
        <option value="50" {% if currentLimit == 50 %}selected{% endif %}>50</option>
        <option value="100" {% if currentLimit == 100 %}selected{% endif %}>100</option>
    </select>
    <button type="submit">Filtrer</button>
    <a href="{{ path('admin_apprenant_index') }}">RÃ©initialiser</a>
</form>

<div style="margin: 10px 0;">
    Total: {{ total|default(apprenants|length) }}
</div>

<table border="1">
    <tr>
        <th>ID</th>
        <th>Email</th>
        <th>Nom</th>
        <th>PrÃ©nom</th>
        <th>Actions</th>
    </tr>
    {% for apprenant in apprenants %}
        <tr>
            <td>{{ apprenant.id }}</td>
            <td>{{ apprenant.user.email }}</td>
            <td>{{ apprenant.user.nom }}</td>
            <td>{{ apprenant.user.prenom }}</td>
            <td>
                <a href="{{ path('admin_apprenant_show', {id: apprenant.id}) }}">ğŸ‘ï¸</a>
                <a href="{{ path('admin_apprenant_edit', {id: apprenant.id}) }}">âœï¸</a>
                <form method="post" action="{{ path('admin_apprenant_delete', {id: apprenant.id}) }}" style="display:inline" onsubmit="return confirm('Supprimer ?')">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ apprenant.id) }}">
                    <button type="submit">ğŸ—‘ï¸</button>
                </form>
            </td>
        </tr>
    {% endfor %}
</table>

<div style="margin-top: 10px;">
    {% set currentPage = page|default(1) %}
    {% set pages = totalPages|default(1) %}
    {% set params = { q: q|default(''), limit: limit|default(10) } %}

    {% if currentPage > 1 %}
        <a href="{{ path('admin_apprenant_index', params|merge({page: (currentPage - 1) })) }}">â† PrÃ©cÃ©dent</a>
    {% else %}
        <span style="color:#999;">â† PrÃ©cÃ©dent</span>
    {% endif %}

    Page {{ currentPage }} / {{ pages }}

    {% if currentPage < pages %}
        <a href="{{ path('admin_apprenant_index', params|merge({page: (currentPage + 1) })) }}">Suivant â†’</a>
    {% else %}
        <span style="color:#999;">Suivant â†’</span>
    {% endif %}
</div>
{% endblock %}
